"use strict";(self.webpackChunkweb_app=self.webpackChunkweb_app||[]).push([[21],{68456:(e,a,t)=>{t.d(a,{QT:()=>l,YH:()=>o,mo:()=>r});var s=t(61889),n=t(75952),i=t(80184);const r=()=>(0,i.jsxs)(s.ZP,{container:!0,columnGap:1,children:[(0,i.jsx)(s.ZP,{children:(0,i.jsx)(n.gyG,{width:"16px",height:"16px"})}),(0,i.jsx)(s.ZP,{item:!0,children:"Open ID"})]}),l=()=>(0,i.jsxs)(s.ZP,{container:!0,columnGap:1,children:[(0,i.jsx)(s.ZP,{children:(0,i.jsx)(n.vcZ,{width:"16px",height:"16px"})}),(0,i.jsx)(s.ZP,{item:!0,children:"LDAP / Active Directory"})]}),o=()=>(0,i.jsxs)(s.ZP,{container:!0,columnGap:1,children:[(0,i.jsx)(s.ZP,{children:(0,i.jsx)(n.oyc,{width:"16px",height:"16px"})}),(0,i.jsx)(s.ZP,{item:!0,children:"Built-in"})]})},37021:(e,a,t)=>{t.r(a),t.d(a,{default:()=>P});var s=t(72791),n=t(78687),i=t(51691),r=t(20890),l=t(96040),o=t(13400),d=t(75952),c=t(61889),u=t(11135),m=t(25787),h=t(20165),p=t(3579),x=t(23814),v=t(68456),_=t(84741),j=t(40968),g=t(87995),D=t(41320),Z=t(83679),N=t(21435),S=t(37516),f=t(40306),b=t(81207),I=t(42419),y=t(27247),k=t(50896),A=t(80184);function w(){return null}const C=(0,n.$j)((e=>({loadingTenant:e.tenants.loadingTenant,selectedTenant:e.tenants.currentTenant,tenant:e.tenants.tenantInfo})),null),P=(0,m.Z)((e=>(0,u.Z)({adUserDnRows:{display:"flex",marginBottom:10},buttonTray:{marginLeft:10,display:"flex",height:38,"& button":{background:"#EAEAEA"}},...x.oZ,...x.bK,loaderAlign:{textAlign:"center"},...x.Bz,...x.QV,...x.DF,...x.oO,...x.AK})))(C((e=>{let{classes:a}=e;const t=(0,D.TL)(),u=(0,n.v9)((e=>e.tenants.tenantInfo)),m=(0,n.v9)((e=>e.tenants.loadingTenant)),[x,C]=(0,s.useState)(!1),[P,R]=(0,s.useState)(!1),[F,T]=(0,s.useState)("Built-in"),[L,O]=(0,s.useState)(""),[U,B]=(0,s.useState)(""),[G,q]=(0,s.useState)(""),[z,K]=(0,s.useState)(!1),[E,H]=(0,s.useState)(""),[V,M]=(0,s.useState)(""),[Q,Y]=(0,s.useState)(""),[W,$]=(0,s.useState)(""),[J,X]=(0,s.useState)(""),[ee,ae]=(0,s.useState)(""),[te,se]=(0,s.useState)(!1),[ne,ie]=(0,s.useState)(""),[re,le]=(0,s.useState)(""),[oe,de]=(0,s.useState)(""),[ce,ue]=(0,s.useState)(""),[me,he]=(0,s.useState)(!1),[pe,xe]=(0,s.useState)(!1),[ve,_e]=(0,s.useState)(!1),[je,ge]=(0,s.useState)([""]),[De,Ze]=(0,s.useState)([""]),[Ne,Se]=(0,s.useState)({}),fe=e=>{Se((0,_.h)(Ne,e))},[be,Ie]=(0,s.useState)(!1);(0,s.useEffect)((()=>{let e=[];"OpenID"===F&&(e=[...e,{fieldKey:"openID_CONFIGURATION_URL",required:!0,value:L},{fieldKey:"openID_clientID",required:!0,value:U},{fieldKey:"openID_secretID",required:!0,value:G},{fieldKey:"openID_claimName",required:!1,value:V}]),"AD"===F&&(e=[...e,{fieldKey:"AD_URL",required:!0,value:W},{fieldKey:"ad_lookupBindDN",required:!0,value:J}]);const a=(0,j.R)(e);Ie(0===Object.keys(a).length),Se(a)}),[F,L,U,G,V,W,J]);const ye=(0,s.useCallback)((()=>{b.Z.invoke("GET","/api/v1/namespaces/".concat(null===u||void 0===u?void 0:u.namespace,"/tenants/").concat(null===u||void 0===u?void 0:u.name,"/identity-provider")).then((e=>{e&&(e.oidc?(T("OpenID"),O(e.oidc.configuration_url),B(e.oidc.client_id),q(e.oidc.secret_id),H(e.oidc.callback_url),M(e.oidc.claim_name),Y(e.oidc.scopes)):e.active_directory&&(T("AD"),$(e.active_directory.url),X(e.active_directory.lookup_bind_dn),ae(e.active_directory.lookup_bind_password),ie(e.active_directory.user_dn_search_base_dn),le(e.active_directory.user_dn_search_filter),de(e.active_directory.group_search_base_dn),ue(e.active_directory.group_search_filter),he(e.active_directory.skip_tls_verification),xe(e.active_directory.server_insecure),_e(e.active_directory.server_start_tls)))})).catch((e=>{t((0,g.Ih)(e))}))}),[u,t]);(0,s.useEffect)((()=>{u&&ye()}),[u,ye]);return(0,A.jsxs)(s.Fragment,{children:[(0,A.jsx)(f.Z,{title:"Save and Restart",confirmText:"Restart",cancelText:"Cancel",titleIcon:(0,A.jsx)(d.EjK,{}),isLoading:x,onClose:()=>R(!1),isOpen:P,onConfirm:()=>{C(!0);let e={};switch(F){case"AD":e.active_directory={url:W,lookup_bind_dn:J,lookup_bind_password:ee,user_dn_search_base_dn:ne,user_dn_search_filter:re,group_search_base_dn:oe,group_search_filter:ce,skip_tls_verification:me,server_insecure:pe,server_start_tls:ve};break;case"OpenID":e.oidc={configuration_url:L,client_id:U,secret_id:G,callback_url:E,claim_name:V,scopes:Q}}b.Z.invoke("POST","/api/v1/namespaces/".concat(null===u||void 0===u?void 0:u.namespace,"/tenants/").concat(null===u||void 0===u?void 0:u.name,"/identity-provider"),e).then((()=>{C(!1),R(!1),ye()})).catch((e=>{t((0,g.Ih)(e)),C(!1)}))},confirmationContent:(0,A.jsx)(i.Z,{children:"Are you sure you want to save the changes and restart the service?"})}),m?(0,A.jsx)("div",{className:a.loaderAlign,children:(0,A.jsx)(d.aNw,{})}):(0,A.jsxs)(s.Fragment,{children:[(0,A.jsxs)(c.ZP,{item:!0,xs:12,children:[(0,A.jsx)("h1",{className:a.sectionTitle,children:"Identity Provider"}),(0,A.jsx)(w,{})]}),(0,A.jsx)(c.ZP,{item:!0,xs:12,className:a.protocolRadioOptions,paddingBottom:1,children:(0,A.jsx)(Z.Z,{currentSelection:F,id:"idp-options",name:"idp-options",label:"Protocol",onChange:e=>{T(e.target.value)},selectorOptions:[{label:(0,A.jsx)(v.YH,{}),value:"Built-in"},{label:(0,A.jsx)(v.mo,{}),value:"OpenID"},{label:(0,A.jsx)(v.QT,{}),value:"AD"}]})}),"OpenID"===F&&(0,A.jsxs)(s.Fragment,{children:[(0,A.jsx)(c.ZP,{item:!0,xs:12,className:a.formFieldRow,children:(0,A.jsx)(N.Z,{id:"openID_CONFIGURATION_URL",name:"openID_CONFIGURATION_URL",onChange:e=>{O(e.target.value),fe("openID_CONFIGURATION_URL")},label:"Configuration URL",value:L,placeholder:"https://your-identity-provider.com/.well-known/openid-configuration",error:Ne.openID_CONFIGURATION_URL||"",required:!0})}),(0,A.jsx)(c.ZP,{item:!0,xs:12,className:a.formFieldRow,children:(0,A.jsx)(N.Z,{id:"openID_clientID",name:"openID_clientID",onChange:e=>{B(e.target.value),fe("openID_clientID")},label:"Client ID",value:U,error:Ne.openID_clientID||"",required:!0})}),(0,A.jsx)(c.ZP,{item:!0,xs:12,className:a.formFieldRow,children:(0,A.jsx)(N.Z,{type:z?"text":"password",id:"openID_secretID",name:"openID_secretID",onChange:e=>{q(e.target.value),fe("openID_secretID")},label:"Secret ID",value:G,error:Ne.openID_secretID||"",required:!0,overlayIcon:z?(0,A.jsx)(h.Z,{}):(0,A.jsx)(p.Z,{}),overlayAction:()=>K(!z)})}),(0,A.jsx)(c.ZP,{item:!0,xs:12,className:a.formFieldRow,children:(0,A.jsx)(N.Z,{id:"openID_claimName",name:"openID_claimName",onChange:e=>{M(e.target.value),fe("openID_claimName")},label:"Claim Name",value:V,placeholder:"policy",error:Ne.openID_claimName||""})}),(0,A.jsx)(c.ZP,{item:!0,xs:12,className:a.formFieldRow,children:(0,A.jsx)(N.Z,{id:"openID_scopes",name:"openID_scopes",onChange:e=>{Y(e.target.value),fe("openID_scopes")},label:"Scopes",value:Q})})]}),"AD"===F&&(0,A.jsxs)(s.Fragment,{children:[(0,A.jsx)(c.ZP,{item:!0,xs:12,className:a.formFieldRow,children:(0,A.jsx)(N.Z,{id:"AD_URL",name:"AD_URL",onChange:e=>{$(e.target.value),fe("AD_URL")},label:"LDAP Server Address",value:W,placeholder:"ldap-server:636",error:Ne.AD_URL||"",required:!0})}),(0,A.jsx)(c.ZP,{item:!0,xs:12,className:a.formFieldRow,children:(0,A.jsx)(S.Z,{value:"ad_skipTLS",id:"ad_skipTLS",name:"ad_skipTLS",checked:me,onChange:e=>{const a=e.target.checked;he(a)},label:"Skip TLS Verification"})}),(0,A.jsx)(c.ZP,{item:!0,xs:12,className:a.formFieldRow,children:(0,A.jsx)(S.Z,{value:"ad_serverInsecure",id:"ad_serverInsecure",name:"ad_serverInsecure",checked:pe,onChange:e=>{const a=e.target.checked;xe(a)},label:"Server Insecure"})}),pe?(0,A.jsxs)(c.ZP,{item:!0,xs:12,children:[(0,A.jsx)(r.Z,{className:a.error,variant:"caption",display:"block",gutterBottom:!0,children:"Warning: All traffic with Active Directory will be unencrypted"}),(0,A.jsx)("br",{})]}):null,(0,A.jsx)(c.ZP,{item:!0,xs:12,className:a.formFieldRow,children:(0,A.jsx)(S.Z,{value:"ad_serverStartTLS",id:"ad_serverStartTLS",name:"ad_serverStartTLS",checked:ve,onChange:e=>{const a=e.target.checked;_e(a)},label:"Start TLS connection to AD/LDAP server"})}),(0,A.jsx)(c.ZP,{item:!0,xs:12,className:a.formFieldRow,children:(0,A.jsx)(N.Z,{id:"ad_lookupBindDN",name:"ad_lookupBindDN",onChange:e=>{X(e.target.value),fe("ad_lookupBindDN")},label:"Lookup Bind DN",value:J,placeholder:"cn=admin,dc=min,dc=io",error:Ne.ad_lookupBindDN||"",required:!0})}),(0,A.jsx)(c.ZP,{item:!0,xs:12,className:a.formFieldRow,children:(0,A.jsx)(N.Z,{type:te?"text":"password",id:"ad_lookupBindPassword",name:"ad_lookupBindPassword",onChange:e=>{ae(e.target.value)},label:"Lookup Bind Password",value:ee,placeholder:"admin",overlayIcon:te?(0,A.jsx)(h.Z,{}):(0,A.jsx)(p.Z,{}),overlayAction:()=>se(!te)})}),(0,A.jsx)(c.ZP,{item:!0,xs:12,className:a.formFieldRow,children:(0,A.jsx)(N.Z,{id:"ad_userDNSearchBaseDN",name:"ad_userDNSearchBaseDN",onChange:e=>{ie(e.target.value)},label:"User DN Search Base DN",value:ne,placeholder:"dc=min,dc=io"})}),(0,A.jsx)(c.ZP,{item:!0,xs:12,className:a.formFieldRow,children:(0,A.jsx)(N.Z,{id:"ad_userDNSearchFilter",name:"ad_userDNSearchFilter",onChange:e=>{le(e.target.value)},label:"User DN Search Filter",value:re,placeholder:"(sAMAcountName=%s)"})}),(0,A.jsx)(c.ZP,{item:!0,xs:12,className:a.formFieldRow,children:(0,A.jsx)(N.Z,{id:"ad_groupSearchBaseDN",name:"ad_groupSearchBaseDN",onChange:e=>{de(e.target.value)},label:"Group Search Base DN",value:oe,placeholder:"ou=hwengg,dc=min,dc=io;ou=swengg,dc=min,dc=io"})}),(0,A.jsx)(c.ZP,{item:!0,xs:12,className:a.formFieldRow,children:(0,A.jsx)(N.Z,{id:"ad_groupSearchFilter",name:"ad_groupSearchFilter",onChange:e=>{ue(e.target.value)},label:"Group Search Filter",value:ce,placeholder:"(&(objectclass=groupOfNames)(member=%s))"})})]}),(0,A.jsx)(c.ZP,{item:!0,xs:12,className:a.buttonContainer,children:(0,A.jsx)(d.zxk,{id:"save-idp",type:"submit",variant:"callAction",color:"primary",disabled:!be||x,onClick:()=>R(!0),label:"Save"})}),"AD"===F&&(0,A.jsxs)(s.Fragment,{children:[(0,A.jsx)(k.Z,{children:"User & Group management"}),(0,A.jsx)("br",{}),(0,A.jsxs)("fieldset",{className:a.fieldGroup,children:[(0,A.jsx)("legend",{className:a.descriptionText,children:"List of user DNs (Distinguished Names) to be added as Tenant Administrators"}),(0,A.jsx)(c.ZP,{item:!0,xs:12,children:je.map(((e,t)=>(0,A.jsx)(s.Fragment,{children:(0,A.jsxs)("div",{className:a.adUserDnRows,children:[(0,A.jsx)(N.Z,{id:"ad-userdn-".concat(t.toString()),label:"",placeholder:"",name:"ad-userdn-".concat(t.toString()),value:je[t],onChange:e=>{ge(je.map(((a,s)=>s===t?e.target.value:a)))},index:t,error:Ne["ad-userdn-".concat(t.toString())]||""},"csv-ad-userdn-".concat(t.toString())),(0,A.jsxs)("div",{className:a.buttonTray,children:[(0,A.jsx)(l.Z,{title:"Add User","aria-label":"add",children:(0,A.jsx)(o.Z,{size:"small",onClick:()=>{ge([...je,""])},children:(0,A.jsx)(I.Z,{})})}),(0,A.jsx)(l.Z,{title:"Remove","aria-label":"add",children:(0,A.jsx)(o.Z,{size:"small",style:{marginLeft:16},onClick:()=>{je.length>1&&ge(je.filter(((e,a)=>a!==t)))},children:(0,A.jsx)(y.Z,{})})})]})]})},"identityField-".concat(t.toString()))))})]}),(0,A.jsxs)("fieldset",{className:a.fieldGroup,children:[(0,A.jsx)("legend",{className:a.descriptionText,children:"List of group DNs (Distinguished Names) to be added as Tenant Administrators"}),(0,A.jsx)(c.ZP,{item:!0,xs:12,children:De.map(((e,t)=>(0,A.jsx)(s.Fragment,{children:(0,A.jsxs)("div",{className:a.adUserDnRows,children:[(0,A.jsx)(N.Z,{id:"ad-groupdn-".concat(t.toString()),label:"",placeholder:"",name:"ad-groupdn-".concat(t.toString()),value:De[t],onChange:e=>{Ze(De.map(((a,s)=>s===t?e.target.value:a)))},index:t,error:Ne["ad-groupdn-".concat(t.toString())]||""},"csv-ad-groupdn-".concat(t.toString())),(0,A.jsxs)("div",{className:a.buttonTray,children:[(0,A.jsx)(l.Z,{title:"Add Group","aria-label":"add",children:(0,A.jsx)(o.Z,{size:"small",onClick:()=>{Ze([...De,""])},children:(0,A.jsx)(I.Z,{})})}),(0,A.jsx)(l.Z,{title:"Remove","aria-label":"add",children:(0,A.jsx)(o.Z,{size:"small",style:{marginLeft:16},onClick:()=>{De.length>1&&Ze(De.filter(((e,a)=>a!==t)))},children:(0,A.jsx)(y.Z,{})})})]})]})},"identityField-".concat(t.toString()))))})]}),(0,A.jsx)("br",{}),(0,A.jsx)(c.ZP,{item:!0,xs:12,className:a.buttonContainer,children:(0,A.jsx)(d.zxk,{id:"add-additional-dns",type:"submit",variant:"callAction",disabled:!be||x,onClick:()=>(()=>{C(!0);let e={};"AD"===F&&(e={user_dns:je.filter((e=>""!==e.trim())),group_dns:De.filter((e=>""!==e.trim()))});b.Z.invoke("POST","/api/v1/namespaces/".concat(null===u||void 0===u?void 0:u.namespace,"/tenants/").concat(null===u||void 0===u?void 0:u.name,"/set-administrators"),e).then((()=>{C(!1),Ze([""]),ge([""]),ye(),t((0,g.y1)("Administrators added successfully"))})).catch((e=>{t((0,g.Ih)(e)),C(!1)}))})(),label:"Add additional DNs"})})]})]})]})})))},42419:(e,a,t)=>{var s=t(64836);a.Z=void 0;var n=s(t(45649)),i=t(80184),r=(0,n.default)((0,i.jsx)("path",{d:"M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6v2z"}),"Add");a.Z=r},27247:(e,a,t)=>{var s=t(64836);a.Z=void 0;var n=s(t(45649)),i=t(80184),r=(0,n.default)((0,i.jsx)("path",{d:"M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6v12zM19 4h-3.5l-1-1h-5l-1 1H5v2h14V4z"}),"Delete");a.Z=r}}]);
//# sourceMappingURL=21.76c78632.chunk.js.map